<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<!--
  - Application context definition for "springDispatcher" DispatcherServlet.
  -->

	<beans>
	    <bean id="springController" class="org.openmrs.web.controller.SpringController"/>
	
	    <bean id="urlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
	        <property name="mappings">
	            <props>
	                <prop key="**/*.htm">springController</prop>
	                <prop key="**/orderType.list">orderTypeList</prop>
	                <prop key="**/orderType.form">orderTypeForm</prop>
	                <prop key="**/patient.form">patientForm</prop>
	                <prop key="**/tribe.list">tribeList</prop>
	                <prop key="**/tribe.form">tribeForm</prop>
	                <prop key="**/patientIdentifierType.list">patientIdentifierTypeList</prop>
	                <prop key="**/patientIdentifierType.form">patientIdentifierTypeForm</prop>
	                <prop key="**/mimeType.list">mimeTypeList</prop>
	                <prop key="**/mimeType.form">mimeTypeForm</prop>
	            </props>
	        </property>
	    </bean>

	    <!-- ================================ -->	    
	    <!-- ====== Observation Sector ====== -->
	    <!-- ================================ -->

			<!-- ** Mime Type ** -->
				<!--this is the optional method of declaring values in the constructor -->
				<!--<bean id="mimeTypeList" class="org.openmrs.web.controller.observation.MimeTypeListController" />-->
				<!--<bean id="mimeTypeForm" class="org.openmrs.web.controller.observation.MimeTypeFormController" />-->
	
				<bean id="mimeTypeList" class="org.openmrs.web.controller.observation.MimeTypeListController">
					<property name="sessionForm"><value>true</value></property>
					<property name="commandName"><value>mimeTypeList</value></property>
					<property name="formView"><value>mimeTypeList.jsp</value></property>
					<property name="successView"><value>mimeType.list</value></property>
				</bean>
		
				<!--  Validator and Form Controller for the add/edit order types page -->
				<bean id="mimeTypeValidator" class="org.openmrs.web.controller.observation.MimeTypeValidator"/>
				<bean id="mimeTypeForm" class="org.openmrs.web.controller.observation.MimeTypeFormController">
					<property name="sessionForm"><value>true</value></property>
					<property name="commandName"><value>mimeType</value></property>
					<property name="validator"><ref bean="mimeTypeValidator"/></property>
					<property name="formView"><value>mimeTypeForm.jsp</value></property>
					<property name="successView"><value>mimeType.list</value></property>
				</bean>
			<!-- ** /Mime Type ** -->
		<!-- ====== /Observation Sector ====== -->

	    <!-- ========================== -->	    
	    <!-- ====== Order Sector ====== -->
	    <!-- ========================== -->

			<!-- ** Order Type ** -->
				<!--this is the optional method of declaring values in the constructor -->
				<!--<bean id="orderTypeList" class="org.openmrs.web.controller.OrderTypeListController" />-->
				<!--<bean id="orderTypeForm" class="org.openmrs.web.controller.OrderTypeFormController" />-->
	
				<bean id="orderTypeList" class="org.openmrs.web.controller.order.OrderTypeListController">
					<property name="sessionForm"><value>true</value></property>
					<property name="commandName"><value>orderTypeList</value></property>
					<property name="formView"><value>orderTypeList.jsp</value></property>
					<property name="successView"><value>orderType.list</value></property>
				</bean>
		
				<!--  Validator and Form Controller for the add/edit order types page -->
				<bean id="orderTypeValidator" class="org.openmrs.web.controller.order.OrderTypeValidator"/>
				<bean id="orderTypeForm" class="org.openmrs.web.controller.order.OrderTypeFormController">
					<property name="sessionForm"><value>true</value></property>
					<property name="commandName"><value>orderType</value></property>
					<property name="validator"><ref bean="orderTypeValidator"/></property>
					<property name="formView"><value>orderTypeForm.jsp</value></property>
					<property name="successView"><value>orderType.list</value></property>
				</bean>
			<!-- ** /Order Type ** -->
		<!-- ====== /Order Sector ====== -->

		
	    <!-- ========================== -->
		<!-- ===== Patient Sector ===== -->
	    <!-- ========================== -->
	    
	    	<!-- ** Patient ** -->
				<bean id="patientValidator" class="org.openmrs.web.controller.patient.PatientValidator"/>
				<bean id="patientForm" class="org.openmrs.web.controller.patient.PatientFormController">
					<property name="sessionForm"><value>true</value></property>
					<property name="commandName"><value>patient</value></property>
					<property name="validator"><ref bean="patientValidator"/></property>
					<property name="formView"><value>patientForm.jsp</value></property>
					<property name="successView"><value>index.htm</value></property>
				</bean>
			<!-- ** /Patient ** -->
			<!-- **  Tribe   ** -->
				<bean id="tribeList" class="org.openmrs.web.controller.patient.TribeListController">
					<property name="sessionForm"><value>true</value></property>
					<property name="commandName"><value>tribeList</value></property>
					<property name="formView"><value>tribeList.jsp</value></property>
					<property name="successView"><value>tribe.list</value></property>
				</bean>
				<bean id="tribeValidator" class="org.openmrs.web.controller.patient.TribeValidator"/>
				<bean id="tribeForm" class="org.openmrs.web.controller.patient.TribeFormController">
					<property name="sessionForm"><value>true</value></property>
					<property name="commandName"><value>tribe</value></property>
					<property name="validator"><ref bean="tribeValidator"/></property>
					<property name="formView"><value>tribeForm.jsp</value></property>
					<property name="successView"><value>tribe.list</value></property>
				</bean>
			<!-- ** /Tribe   ** -->
			<!-- **  Patient Identifier Type   ** -->
				<bean id="patientIdentifierTypeList" class="org.openmrs.web.controller.patient.PatientIdentifierTypeListController">
					<property name="sessionForm"><value>true</value></property>
					<property name="commandName"><value>patientIdentifierTypeList</value></property>
					<property name="formView"><value>patientIdentifierTypeList.jsp</value></property>
					<property name="successView"><value>patientIdentifierType.list</value></property>
				</bean>
				<bean id="patientIdentifierTypeValidator" class="org.openmrs.web.controller.patient.PatientIdentifierTypeValidator"/>
				<bean id="patientIdentifierTypeForm" class="org.openmrs.web.controller.patient.PatientIdentifierTypeFormController">
					<property name="sessionForm"><value>true</value></property>
					<property name="commandName"><value>patientIdentifierType</value></property>
					<property name="validator"><ref bean="patientIdentifierTypeValidator"/></property>
					<property name="formView"><value>patientIdentifierTypeForm.jsp</value></property>
					<property name="successView"><value>patientIdentifierType.list</value></property>
				</bean>
			<!-- ** /Patient Identifier Type   ** -->			
		
		<!-- ====== /Patient Sector ====== -->

		<bean id="messageSource" class="org.springframework.context.support.ResourceBundleMessageSource">
			<property name="basename">
				<value>messages</value>
			</property>

		</bean>

	</beans>




<!--<beans>-->

	<!-- Hibernate SessionFactory -->
	<!-- 
	<bean id="sessionFactory"
		class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
		<property name="configLocation" value="hibernate.cfg.xml" />
	</bean>
	-->

	<!-- Transaction manager for a single Hibernate SessionFactory (alternative to JTA) -->
	<!-- 
	<bean id="transactionManager"
		class="org.springframework.orm.hibernate3.HibernateTransactionManager">
		<property name="sessionFactory" ref="sessionFactory" />
	</bean>
	-->

	<!-- ### for ***EVERY*** domain object! Ouch!
		<bean id="myProductDao" class="product.ProductDaoImpl">
		<property name="sessionFactory">
		<ref bean="mySessionFactory" />
		</property>
		<property name="exampleParam">
		<value>someValue</value>
		</property>
		</bean>
	-->
	
	<!--  Default context -->
	<!-- 
	<bean id="defaultContextTarget" class="org.openmrs.context.HibernateContext">
		<property name="sessionFactory">
			<ref bean="sessionFactory" />
		</property>
	</bean>
	
	<bean id="defaultContext"
		class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
		<property name="transactionManager" ref="transactionManager" />
		<property name="target" ref="defaultContextTarget" />
		<property name="transactionAttributes">
			<props>
				<prop key="*">PROPAGATION_REQUIRED,readOnly</prop>
			</props>
		</property>
	</bean>
	-->
	
	
	
	<!--<bean id="defaultContext"
		class="org.openmrs.context.IbatisContext" />-->
	
	
		

	<!--  User service -->
	<!-- 
	<bean id="userServiceTarget"
		class="org.openmrs.api.hibernate.HibernateUserService">
		<property name="sessionFactory">
			<ref bean="sessionFactory" />
		</property>
	</bean>

	<bean id="userService"
		class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
		<property name="transactionManager" ref="transactionManager" />
		<property name="target" ref="userServiceTarget" />
		<property name="transactionAttributes">
			<props>
				<prop key="get*">PROPAGATION_REQUIRED,readOnly</prop>
				<prop key="find*">PROPAGATION_REQUIRED,readOnly</prop>
				<prop key="load*">PROPAGATION_REQUIRED,readOnly</prop>
				<prop key="store*">PROPAGATION_REQUIRED</prop>
			</props>
		</property>
	</bean>
	-->

	<!-- 
	<bean id="patientServiceTarget"
		class="org.openmrs.api.hibernate.HibernatePatientService">
		<property name="sessionFactory"><ref bean="sessionFactory" /></property>
	</bean>
	
	<bean id="patientService"
		class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
		<property name="transactionManager" ref="transactionManager" />
		<property name="target" ref="patientServiceTarget" />
		<property name="transactionAttributes">
			<props>
				<prop key="get*">PROPAGATION_REQUIRED,readOnly</prop>
				<prop key="find*">PROPAGATION_REQUIRED,readOnly</prop>
				<prop key="load*">PROPAGATION_REQUIRED,readOnly</prop>
				<prop key="store*">PROPAGATION_REQUIRED</prop>
			</props>
		</property>
	</bean>
	-->

	<!--
	<bean id="loginValidator" class="org.openmrs.web.LoginValidator" />
	<bean id="loginForm" class="org.openmrs.web.LoginController">
		<property name="commandName" value="credentials" />
		<property name="commandClass" value="org.openmrs.web.Credentials" />
		<property name="validator"><ref bean="loginValidator" /></property>
		<property name="formView" value="login/login" />
		<property name="successView" value="/formentry/welcome" />
	</bean>

	<bean id="patientSearchValidator"
		class="org.openmrs.formentry.web.PatientSearchValidator" />
	<bean id="patientSearchForm"
		class="org.openmrs.formentry.web.PatientSearchFormController">
		<property name="commandName" value="query" />
		<property name="commandClass"
			value="org.openmrs.formentry.web.SimpleQueryCommand" />
		<property name="validator"><ref bean="patientSearchValidator" /></property>
		<property name="formView" value="formentry/patientSearch" />
		<property name="successView" value="formentry/selectPatient" />
	</bean>

	<bean id="selectPatientValidator"
		class="org.openmrs.formentry.web.SelectPatientValidator" />
	<bean id="selectPatientForm"
		class="org.openmrs.formentry.web.SelectPatientFormController">
		<property name="commandName" value="query" />
		<property name="commandClass"
			value="org.openmrs.formentry.web.SimpleQueryCommand" />
		<property name="validator"><ref bean="selectPatientValidator" /></property>
		<property name="formView" value="/formentry/selectPatient" />
		<property name="successView" value="selectForm.form" />
	</bean>

	<bean id="urlMapping"
		class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
		<property name="interceptors">
			<list>
				<ref bean="openSessionInViewInterceptor" />
			</list>
		</property>
		<property name="mappings">
			<props>
				<prop key="/login.form">loginForm</prop>
				<prop key="/formentry/patientSearch.form">patientSearchForm</prop>
				<prop key="/formentry/selectPatient.form">selectPatientForm</prop>
			</props>
		</property>
	</bean>

	<bean id="messageSource"
		class="org.springframework.context.support.ResourceBundleMessageSource">
		<property name="basename"><value>message</value></property>
	</bean>

	<bean id="viewResolver"
		class="org.springframework.web.servlet.view.JstlView">
		<property name="prefix" value="/WEB-INF/view/" />
		<property name="suffix" value=".jsp" />
	</bean>

	<bean name="openSessionInViewInterceptor"
		class="org.springframework.orm.hibernate3.support.OpenSessionInViewInterceptor">
		<property name="sessionFactory"><ref bean="sessionFactory" /></property>
	</bean>
	-->

	<!--
		- This bean resolves specific types of exception to corresponding error views.
		- The default behaviour of DispatcherServlet is to propagate all exceptions to the
		- servlet container: This will happen here with all other types of exception.
	-->
	<!--
	<bean id="exceptionResolver"
		class="org.springframework.web.servlet.handler.SimpleMappingExceptionResolver">
		<property name="exceptionMappings">
			<props>
				<prop key="org.springframework.dao.DataAccessException">
					dataAccessFailure
				</prop>
				<prop key="org.springframework.transaction.TransactionException">
					dataAccessFailure
				</prop>
			</props>
		</property>
	</bean>
	-->

<!--</beans>-->