<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
    "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
    "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd" >
    
<hibernate-mapping>
<!-- 
    Created by the Middlegen Hibernate plugin 2.1

    http://boss.bekk.no/boss/middlegen/
    http://www.hibernate.org/
-->

<class 
    name="org.openmrs.Order" 
    table="orders" discriminator-value="null"
>

    <id
        name="orderId"
        type="int"
        column="order_id"
        unsaved-value="0"
    >
        <generator class="native" />
    </id>
	
    <discriminator column="order_type" type="string" not-null="false" insert="false" />
	
	<property name="uuid" type="java.lang.String"
		column="uuid" length="38" unique="true" not-null="true"/>

    <property
        name="instructions"
        type="java.lang.String"
        column="instructions"
        length="65535"
    />
    <property
        name="startDate"
        type="java.util.Date"
        column="start_date"
        length="19"
    />
    <property
        name="autoExpireDate"
        type="java.util.Date"
        column="auto_expire_date"
        length="19"
    />
	<property
		name="discontinued"
		type="java.lang.Boolean"
		column="discontinued"
		length="1"
		not-null="true"
	/>
    <property
        name="discontinuedDate"
        type="java.util.Date"
        column="discontinued_date"
        length="19"
    />
    <property name="accessionNumber" type="java.lang.String" column="accession_number" length="255" />
    <property
        name="dateCreated"
        type="java.util.Date"
        column="date_created"
        not-null="true"
        length="19"
    />
	<property 
		name="voided" 
		type="java.lang.Boolean" 
		column="voided"
		length="1" 
		not-null="true"
	/>
	<property
        name="dateVoided"
        type="java.util.Date"
        column="date_voided"
        length="19"
    />
    <property
        name="voidReason"
        type="java.lang.String"
        column="void_reason"
        length="255"
    />
    <property
        name="discontinuedReasonNonCoded"
        type="java.lang.String"
        column="discontinued_reason_non_coded"
        length="255"
    />

    <!-- Associations -->
  
    <!-- bi-directional many-to-one association to Concept -->
    <many-to-one
        name="concept"
        class="org.openmrs.Concept"
        not-null="true"
    >
        <column name="concept_id" />
    </many-to-one>
    <!-- bi-directional many-to-one association to Encounter -->
    <many-to-one
        name="encounter"
        class="org.openmrs.Encounter"
    >
        <column name="encounter_id" />
    </many-to-one>

    <!-- bi-directional many-to-one association to Encounter -->
    <many-to-one
        name="patient"
        class="org.openmrs.Patient"
        not-null="true"
    >
        <column name="patient_id" />
    </many-to-one>

    <!-- bi-directional many-to-one association to Concept -->
    <many-to-one
        name="discontinuedReason"
        class="org.openmrs.Concept"
        not-null="false"
    >
        <column name="discontinued_reason" />
    </many-to-one>

    <!-- bi-directional many-to-one association to User -->
    <many-to-one
        name="orderer"
        class="org.openmrs.User"
    >
        <column name="orderer" />
    </many-to-one>

    <!-- bi-directional many-to-one association to User -->
    <many-to-one
        name="voidedBy"
        class="org.openmrs.User"
    >
        <column name="voided_by" />
    </many-to-one>
    <!-- bi-directional many-to-one association to User -->
    <many-to-one
        name="discontinuedBy"
        class="org.openmrs.User"
    >
        <column name="discontinued_by" />
    </many-to-one>
    <!-- bi-directional many-to-one association to User -->
    <many-to-one
        name="creator"
        class="org.openmrs.User"
        not-null="true"
    >
        <column name="creator" />
    </many-to-one>
	
    <property name="orderNumber" type="java.lang.String" column="order_number" length="50" not-null="true"/>
    <property name="previousOrderNumber" type="java.lang.String" column="previous_order_number" length="50" />
    <property name="nonCodedName" type="java.lang.String" column="noncoded_name" length="255" />
    <property name="urgency" type="java.lang.String" column="urgency" length="50" />
    <property name="conditionality" type="java.lang.String" column="conditionality" length="255" />
    <property name="frequency" type="java.lang.String" column="frequency" length="50" />  
	<property name="comment" type="java.lang.String" column="comment" length="65535" />
	
	<many-to-one name="indication" column="indication" class="org.openmrs.Concept" />
	<many-to-one name="signedBy" class="org.openmrs.User">
        <column name="signed_by" />
    </many-to-one>
    
    <property name="dateSigned" type="java.util.Date" column="date_signed" length="19" />
    
    <many-to-one name="activatedBy" class="org.openmrs.User">
        <column name="activated_by" />
    </many-to-one>
    
    <property name="dateActivated" type="java.util.Date" column="date_activated" length="19" />
	<property name="filler" type="java.lang.String" column="filler" length="255" />
	<property name="dateFilled" type="java.util.Date" column="date_filled" length="19" />
	
	<property name="orderAction" column="order_action" length="50" not-null="true">
		<type name="org.openmrs.util.HibernateEnumType">
			<param name="enumClassName">org.openmrs.Order$OrderAction</param>
		</type>
	</property>
	
	<many-to-one name="orderGroup" class="org.openmrs.OrderGroup" not-null="false">
        	<column name="order_group" />
   	</many-to-one>

	<subclass name="org.openmrs.DrugOrder" discriminator-value="DRUG">
		<join table="drug_order">
			<key column="order_id" />
		
			<property name="dose" type="double" column="dose" length="22" />
			<property name="equivalentDailyDose" type="double" column="equivalent_daily_dose" length="22" />
	    	<property name="units" type="java.lang.String" column="units" length="255" />
	    	<property name="frequency" type="java.lang.String" column="frequency" length="255" />
	    	<property name="prn" type="boolean" column="prn" length="1" not-null="true" />
	    	<property name="unstructuredDosing" type="java.lang.String" column="unstructured_dosing" length="255" />
			<property name="quantity" type="int" column="quantity" length="11" />
	    
			<!-- bi-directional many-to-one association to Drug -->
			<many-to-one name="drug" class="org.openmrs.Drug" not-null="true">
				<column name="drug_inventory_id" />
			</many-to-one>
    	
    		<property name="brandName" type="java.lang.String" column="brand_name" length="255" />
    		<property name="strength" type="double" column="strength" length="22" />
    		<property name="strengthUnits" type="java.lang.String" column="strength_units" length="255" />
    		<property name="dosageForm" type="java.lang.String" column="dosage_form" length="50" />
    		<property name="route" type="java.lang.String" column="route" length="50" />    	
     		<property name="asNeededCondition" type="java.lang.String" column="as_needed_condition" length="255" />	
    		<property name="additionalInstructions" type="java.lang.String" column="additional_instructions" length="65535" />	
    		<property name="numRefills" type="int" column="num_refills" length="11" />
    		<property name="quantityUnits" type="java.lang.String" column="quantity_units" length="50" />
    		<property name="duration" type="int" column="duration" length="11" />
    		<property name="durationUnits" type="java.lang.String" column="duration_units" length="50" />
		</join> 
	</subclass>
	
	<subclass name="org.openmrs.TestOrder" discriminator-value="TEST">
		<join table="test_order">	
    		<key column="order_id" />
    	
    		<property name="specimenSource" type="int" column="specimen_source" length="11" />    	
    		<property name="laterality" type="int" column="laterality" length="11" />    	
    		<property name="clinicalHistory" type="java.lang.String" column="clinical_history" length="65535" />
		</join> 
	</subclass>

</class>
</hibernate-mapping>
